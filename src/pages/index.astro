---
import { getCollection } from 'astro:content';
import Header from "@components/Header";
import Hero from "@components/Hero";
import Services from "@components/Services";
import About from "@components/About";
import Process from "@components/Process";
import Gallery from "@components/Gallery";
import Formations from "@components/Formations";
import Team from "@components/Team";
import Testimonials from "@components/Testimonials";
import FAQ from "@components/FAQ";
import Newsletter from "@components/Newsletter";
import Contact from "@components/Contact";
import Footer from "@components/Footer";
import FloatingCTA from "@components/FloatingCTA";
import ScrollToTop from "@components/ScrollToTop";
import AnimatedSection from "@components/AnimatedSection";
import BaseLayout from "@layouts/BaseLayout.astro";

// Fetch data from collections
const services = await getCollection('services');
const formations = await getCollection('formations');
const teamMembers = await getCollection('team');
const testimonials = await getCollection('testimonials');
const faqs = await getCollection('faqs');
const siteSettingsCollection = await getCollection('siteSettings');
const gallery = await getCollection('gallery');

// Get the first (and only) site settings entry
const siteSettings = siteSettingsCollection.length > 0 ? siteSettingsCollection[0].data : null;
---

<BaseLayout 
  title={siteSettings?.siteName || "Home"} 
  description={siteSettings?.siteDescription || "Welcome to our homepage"}
>
  
<div class="min-h-screen">
  <Header siteSettings={siteSettings} />

  <Hero client:load />

  <AnimatedSection animation="fade-in" client:visible>
    <Services services={services} />
  </AnimatedSection>

  <AnimatedSection animation="slide-up" delay={100} client:visible>
    <About />
  </AnimatedSection>

  <AnimatedSection animation="fade-in" delay={200} client:visible>
    <Process />
  </AnimatedSection>

  <AnimatedSection animation="slide-left" delay={100} client:visible>
    <Gallery gallery={gallery} client:load />
  </AnimatedSection>

  <AnimatedSection animation="scale-in" client:visible>
    <Formations formations={formations} />
  </AnimatedSection>

  <AnimatedSection animation="slide-right" delay={150} client:visible>
    <Team teamMembers={teamMembers} />
  </AnimatedSection>

  <AnimatedSection animation="fade-in" delay={100} client:visible>
    <Testimonials testimonials={testimonials} />
  </AnimatedSection>

  <AnimatedSection animation="slide-up" delay={200} client:visible>
    <FAQ faqs={faqs} client:load />
  </AnimatedSection>

  <AnimatedSection animation="scale-in" delay={100} client:visible>
    <Newsletter />
  </AnimatedSection>

  <AnimatedSection animation="fade-in" client:visible>
    <Contact siteSettings={siteSettings} />
  </AnimatedSection>

  <FloatingCTA client:load />
  <ScrollToTop client:load />
  
  <Footer siteSettings={siteSettings} />
</div>

</BaseLayout>